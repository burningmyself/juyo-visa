<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>客户管理添加</title>
    <link rel="stylesheet" href="/res/plugin/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/res/plugin/kendoui/styles/kendo.common.min.css"/>
    <link rel="stylesheet" href="/res/plugin/kendoui/styles/kendo.office365.min.css"/>
    <link rel="stylesheet" href="/res/plugin/font-awesome/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="/res/css/colors.min.css"/>
    <link rel="stylesheet" href="/res/css/common.min.css?v=1"/>
    <link rel="stylesheet" href="/res/plugin/h+/css/main.css"/><!--修改的样式-->
    <link rel="stylesheet" href="/res/plugin/mui-switch.css"/>
    <link rel="stylesheet" href="/common/tld.jsp" />
    <style type="text/css">
    	.input-group{width:100%;}/*由于删掉小灯泡 宽度出现问题 此处理设置所有input、select等宽度等于父类*/
    </style>
</head>
<body onload="document.getElementById('fullComNameId').focus()">
<div>
    <div class="container-fluid" style="padding-top: 15px;">
        <div class="row">
        	<form id="addForm" method="post">
	            <div class="col-xs-12 padding-0">
	                <ul id="panelbar">
	                    <li>
	                        <div class="container-fluid">
	                            <div class="row">
	                                <div class="col-xs-8">
	                                    <div class="form-group">
	                                        <label for="last_name_cn">公司全称:<span style="color: red">*</span></label>
	                                        <div class='input-group'>
	                                            <input id="fullComNameId" name="fullComName" type="text" placeholder="请输入公司名称" class="k-textbox" style="width: 100%;"/>
	                                            <!-- <span class='input-group-addon'><i class='fa fa-lg fa-fw fa-lightbulb-o'></i></span> -->
	                                        </div>
	                                    </div>
	                                </div>
	                                <div class="col-xs-4">
	                                    <div class="form-group">
	                                        <label for="last_name_en">客户来源:<span style="color: red">*</span></label>
	                                        <div class='input-group'>
	                                            <select id="customerSourceId" name="customerSource" style="width: 100%; height: 29.81px;"
	                                                    data-role="dropdownlist"
	                                                    data-value-primitive="true"
	                                                    data-bind="value:customer.father.inUsa">
	                                                <option value=" ">请选择客户来源</option>
	                                                <option value="1">线上</option>
	                                                <option value="2">OTS</option>
	                                                <option value="3">直客</option>
	                                                <option value="4">线下</option>
	                                            </select>
	                                            <!-- <span class='input-group-addon'><i class='fa fa-lg fa-fw fa-lightbulb-o'></i></span> -->
	                                        </div>
	                                    </div>
	                                </div>
	                            </div>
								<div class="row">
	                                <div class="col-xs-4">
	                                    <div class="form-group">
	                                        <label for="last_name_cn">联系人:<span style="color: red">*</span></label>
	                                        <div class='input-group'>
	                                            <input id="linkmanId" name="linkman" type="text" placeholder="请输入联系人" class="k-textbox" style="width: 100%;"/>
	                                            <!-- <span class='input-group-addon'><i class='fa fa-lg fa-fw fa-lightbulb-o'></i></span> -->
	                                        </div>
	                                    </div>
	                                </div>
	                                <div class="col-xs-4">
	                                    <div class="form-group">
	                                        <label for="last_name_cn">手机:<span style="color: red">*</span></label>
	                                        <div class='input-group'>
	                                            <input id="telephoneId" name="telephone" required pattern="^[1][34578][0-9]{9}$" validationMessage="手机号码格式错误" type="text" placeholder="请输入手机号" class="k-textbox" style="width: 100%;"/>
	                                            <!-- <span class='input-group-addon'><i class='fa fa-lg fa-fw fa-lightbulb-o'></i></span> -->
	                                        </div>
	                                    </div>
	                                </div>
	                                <div class="col-xs-4">
	                                    <div class="form-group">
	                                        <label for="last_name_cn">邮箱:<span style="color: red">*</span></label>
	                                        <div class='input-group'>
	                                            <input id="emailId" name="email" type="text" required pattern="^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$" validationMessage="邮箱格式不正确" placeholder="请输入邮箱" class="k-textbox" style="width: 100%;"/>
	                                            <!-- <span class='input-group-addon'><i class='fa fa-lg fa-fw fa-lightbulb-o'></i></span> -->
	                                        </div>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                    </li>
	                </ul>
	            </div>
	         </form>
        </div>
        <div class="row" data-bind="visible:showToolBar">
            <div class="col-xs-12">
                <div class="form-group">
                    <button id="customerSave" class="k-primary k-button col-xs-12">
                        <i class="fa fa-save"></i> 保存
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<!--引入 js 库文件-->
<script src="/res/plugin/template.js"></script>
<script src="/res/plugin/jquery.min.js"></script>
<script src="/res/plugin/layer/layer.js"></script>
<script src="/res/plugin/kendoui/js/kendo.web.min.js"></script>
<script src="/res/plugin/kendoui/js/cultures/kendo.culture.zh-CN.min.js"></script>
<script src="/res/plugin/kendoui/js/messages/kendo.messages.zh-CN.min.js"></script>
<script src="/res/js/common.js"></script>
<script src="/res/plugin/webtoolkit.md5.js"></script>
<script src="/res/js/idcard.js"></script>
<!-- <script src="/res/js/wintone.js?v=4"></script> -->
<script src="/res/js/projectpath/projectpath.js"></script>
<script type="text/javascript">
//验证输入内容不能为空
$("#addForm").kendoValidator({
	validateOnBlur: true,
	rules: {
      customRule1: function(input) {
    	  if(input.is("[name=fullComName]")) {
    		  var fullComName = $("#fullComNameId").val();
    		  if(fullComName==null || fullComName==""){
	    		  return false;
    		  }
    	  }
    	  return true;
      },
      customRule2: function(input) {
    	  if(input.is("[name=customerSource]")) {
    		  var customerSource = $('#customerSourceId').find("option:selected").text();
    		  if(customerSource == null || customerSource== ""){
    			   return false;
    		  }
    	  }
    	  return true;
      },
      customRule3: function(input) {
    	  if(input.is("[name=linkman]")) {
    		  var linkman = $("#linkmanId").val();
    		  if(linkman == null || linkman== ""){
    				return false;
    			}
    	  }
    	  return true;
      },
      customRule4: function(input) {
    	  if(input.is("[name=telephone]")) {
    		  var telephone = $("#telephoneId").val();
    		  if(telephone == null || telephone== ""){
    				return false;
    			}
    	  }
    	  return true;
      },
      customRule5: function(input) {
          if(input.is("[name=email]")) {
        	  var email = $("#emailId").val();
        	  if(email == null || email== ""){
        			return false;
        		}
          }
          return true;
      }
},
	//自定义验证消息
	messages: {
		customRule1: "公司名称不能为空",
		customRule2: "客户来源不能为空",
		customRule3: "联系人不能为空",
		customRule4: "手机号不能为空",
		customRule5: "邮箱不能为空"
	  }
		
});
//唯一性校验
/* function checkTelephone(){
	var telephone = $("#telephoneId").val();
	$.ajax({
		type : "POST",
		url : localhostPaht +'/visa/customermanagement/checkTelephone',
		data : {
			telephone:telephone
		},
		success : function(data) {
			if(data=="false"){
				layer.msg('手机号码已存在');
				return false;
			}
		},
		error : function(request) {
			layer.msg('手机号码格式有误');
		}
	});
}
function getMessage(input) {
    return input.data("message");
} */
//添加保存
$("#customerSave").click(function(){
	var validatable = $("#addForm").kendoValidator().data("kendoValidator");
	if (validatable) {
		$.ajax({
			type : "POST",
			url : localhostPaht +'/visa/customermanagement/addData',
			data : $('#addForm').serialize(),// 你的formid
			success : function(data) {
				layer.load(1, {
					 shade: [0.1,'#fff'] //0.1透明度的白色背景
				});
				var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
			    parent.layer.close(index);
			    window.parent.successCallback('1');
			},
			error : function(request) {
				layer.msg('添加失败');
			}
		});
	}
});
</script>
</html>
